module.exports=function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";var r=n(5),o=n(73),i=n(6);e.exports=r.createServer(function(e,t,n){return i.info("Starting User Invite Extension - Version:",t("CLIENT_VERSION")),o(t,n)})},function(e,t,n){e.exports.ArgumentError=n(59),e.exports.ForbiddenError=n(60),e.exports.HookTokenError=n(61),e.exports.ManagementApiError=n(62),e.exports.NotFoundError=n(63),e.exports.UnauthorizedError=n(64),e.exports.ValidationError=n(65)},function(e,t,n){const r=n(46),o=n(1),i=n(70),s=e.exports={};s.ArgumentError=o.ArgumentError,s.ForbiddenError=o.ForbiddenError,s.HookTokenError=o.HookTokenError,s.ManagementApiError=o.ManagementApiError,s.NotFoundError=o.NotFoundError,s.UnauthorizedError=o.UnauthorizedError,s.ValidationError=o.ValidationError,s.managementApi=n(57),s.FileStorageContext=i.FileStorageContext,s.WebtaskStorageContext=i.WebtaskStorageContext,s.BlobRecordProvider=n(67),s.config=n(58),s.configProvider=n(21),s.createServer=n(68).createServer,s.validateHookToken=n(66),s.createExpressServer=function(e){return r.fromExpress(s.createServer(e))},s.createHapiServer=function(e){return r.fromHapi(s.createServer(e))}},function(e,t,n){"use strict";e.exports=n(2).config()},function(e,t){e.exports=require("lodash")},function(e,t,n){const r=n(55),o=n(56),i=n(50);e.exports.createServer=r.createServer,e.exports.urlHelpers=o,e.exports.middlewares=i},function(e,t,n){"use strict";var r=n(138);r.emitErrs=!0;var o=new r.Logger({transports:[new r.transports.Console({timestamp:!0,level:"debug",handleExceptions:!0,json:!1,colorize:!0})],exitOnError:!1});e.exports=o,e.exports.stream={write:function(e){o.info(e.replace(/\n$/,""))}}},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("url")},function(e,t){var n=e.exports={version:"2.4.0"};"number"==typeof __e&&(__e=n)},function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},function(e,t){e.exports=require("bluebird")},function(e,t){e.exports=require("path")},function(e,t,n){e.exports=!n(10)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.JwksClient=void 0;var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(18),a=r(u),c=n(44),l=r(c),f=n(33),d=(r(f),n(34)),p=r(d),h=n(36),g=r(h),m=n(120),v=n(122);t.JwksClient=function(){function e(t){var n=this;o(this,e),this.getSigningKey=function(e,t){n.logger("Fetching signing key for '"+e+"'"),n.getSigningKeys(function(r,o){if(r)return t(r);var i=o.find(function(t){return t.kid===e});return i?t(null,i):(n.logger("Unable to find a signing key that matches '"+e+"'"),t(new g["default"]("Unable to find a signing key that matches '"+e+"'")))})},this.options=i({rateLimit:!1,cache:!1,strictSsl:!0},t),this.logger=(0,a["default"])("jwks"),this.options.rateLimit&&(this.getSigningKey=(0,v.rateLimitSigningKey)(this,t)),this.options.cache&&(this.getSigningKey=(0,v.cacheSigningKey)(this,t))}return s(e,[{key:"getKeys",value:function(e){var t=this;this.logger("Fetching keys from '"+this.options.jwksUri+"'"),(0,l["default"])({json:!0,uri:this.options.jwksUri,strictSSL:this.options.strictSsl},function(n,r){return n||r.statusCode<200||r.statusCode>=300?(t.logger("Failure:",r&&r.body||n),e(r?new p["default"](r.body&&(r.body.message||r.body)||r.statusMessage||"Http Error "+r.statusCode):n)):(t.logger("Keys:",r.body.keys),e(null,r.body.keys))})}},{key:"getSigningKeys",value:function(e){var t=this;this.getKeys(function(n,r){if(n)return e(n);if(!r||!r.length)return e(new p["default"]("The JWKS endpoint did not contain any keys"));var o=r.filter(function(e){return"sig"===e.use&&"RSA"===e.kty&&e.kid&&(e.x5c&&e.x5c.length||e.n&&e.e)}).map(function(e){return e.x5c&&e.x5c.length?{kid:e.kid,nbf:e.nbf,publicKey:(0,m.certToPEM)(e.x5c[0])}:{kid:e.kid,nbf:e.nbf,rsaPublicKey:(0,m.rsaPublicKeyToPEM)(e.n,e.e)}});return o.length?(t.logger("Signing Keys:",o),e(null,o)):e(new p["default"]("The JWKS endpoint did not contain any signing keys"))})}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.SigningKeyNotFoundError=t.JwksRateLimitError=t.JwksError=t.ArgumentError=void 0;var o=n(33),i=r(o),s=n(34),u=r(s),a=n(35),c=r(a),l=n(36),f=r(l);t.ArgumentError=i["default"],t.JwksError=u["default"],t.JwksRateLimitError=c["default"],t.SigningKeyNotFoundError=f["default"]},function(e,t){e.exports=require("debug")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("jsonwebtoken")},function(e,t,n){const r=n(4),o=n(1).ArgumentError;e.exports.fromWebtaskContext=function(e){if(null===e||void 0===e)throw new o("Must provide a webtask context");const t=r.assign({},{NODE_ENV:"production",CLIENT_VERSION:"1.0.0",MAX_CSV_RECORDS:100},e.params,e.secrets,{NODE_ENV:"production",HOSTING_ENV:"webtask"});return function(e){return t[e]}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){var n={sort:"last_login:-1",q:"app_metadata.invite.status:"+e.filter,per_page:e.perPage||100,page:e.page||0,include_totals:!0,fields:"user_id,name,email,app_metadata",search_engine:"v2"};e.auth0.users.getAll(n,function(e,n){return e?(v["default"].debug("Error getting users:",e),t(e)):t(null,n)})}function i(e,t,n){return e.auth0.users.create(t,function(e,t){return e?(v["default"].debug("Error creating user",e),n(e)):n(null,t)})}function s(e,t,n,r,o){return w.sendEmail(t,n,function(t,n){return t?(v["default"].debug("Error sending email",t),e.auth0.users["delete"]({id:r.user_id},function(e){return e?(v["default"].debug("Error creating and deleting user",e),o(e)):o({message:"Error sending email. Please confirm that you have set your configurations."})})):o(null,n)})}function u(e,t){var n=f["default"].v4(),r={connection:e.connection,email:e.email,password:f["default"].v4(),app_metadata:{invite:{status:"pending",token:n}}};e.username&&(r.username=e.username);var o=(0,x["default"])((0,g["default"])("NODE_ENV"),e.host,n),u={to:r.email},a={name:"Auth0 Customer",email:r.email,url:o};p["default"].waterfall([p["default"].apply(i,e,r),p["default"].apply(s,e,u,a)],function(e,n){return e?(v["default"].debug("Error creating user",e),t(e)):t(null,n)})}function a(e,t){S(e.auth0,e.token,function(n,r){return n||!r?(v["default"].debug("There was an error when validating the token."),t(n)):r.email_verified?t(null,r):void E(e.auth0,r,function(e,n){return e?(v["default"].debug("There was an error when updating field."),t(e)):t(null,n)})})}function c(e,t){S(e.auth0,e.token,function(n,r){return n||!r||r.user_id!==e.id?(v["default"].debug("There was an error when saving the user."),t(n)):e.auth0.users.update({id:e.id},{password:e.password,app_metadata:{invite:{status:"accepted"}}},function(e,n){return e||!n?(v["default"].debug("There was an error when saving the user."),t(e)):t()})})}var l=n(137),f=r(l),d=n(127),p=r(d),h=n(3),g=r(h),m=n(6),v=r(m),y=n(75),k=r(y),b=n(76),x=r(b),w=null,E=function(e,t,n){return e.users.update({id:t.user_id},{email_verified:!0},function(e,t){return e||!t?(v["default"].debug("There was a problem when updating the user email_verified field.",e),n(e)):n(null,t)})},S=function(e,t,n){var r={sort:"last_login:-1",q:"app_metadata.invite.token:"+t,include_totals:!1,fields:"user_id,email,email_verified,app_metadata",search_engine:"v2"};return e.users.get(r,function(e,t){return!e&&t&&t.length&&1===t.length?n(null,t[0]):(v["default"].debug("Token is invalid or user was not found."),n({message:e||"Token is invalid or user was not found."}))})},_=function(e,t){w=new k["default"](e,t)};e.exports={getUsers:o,createUser:u,validateUserToken:a,savePassword:c,configureEmail:_}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n){if(!e.is("application/json"))return t.status(500).send(new d.ValidationError("Missing JSON information about user."));var r={email:e.body.user.email,username:e.body.user.username};p.validate(r,h,function(e,r){return e?t.status(500).send(new d.ValidationError("Missing information (email or username).")):void n()})}function i(e,t,n){p.validate({filter:e.query.filter},g,function(r,o){return r?t.status(500).send((0,f["default"])({},new d.ValidationError("Missing information (filter)."),{filter:e.query.filter})):void n()})}function s(e,t,n){p.validate(e.query,m,function(e,r){return e?t.status(500).send(new d.ValidationError("No token was provided.")):void n()})}function u(e,t,n){p.validate(e.body,v,function(e,r){return e?t.status(500).send(new d.ValidationError("Missing information (user id, token or password).")):void n()})}function a(e,t,n){p.validate(e.body,y,function(e,r){return e?t.status(500).send(new d.ValidationError("Missing information (from, subject or message).")):void n()})}function c(e,t){p.validate(e,y,function(e,n){t(e,n)})}var l=n(25),f=r(l),d=n(2),p=n(132),h=p.object().keys({email:p.string().email().required(),username:p.string().allow("").optional()}),g=p.object().keys({filter:p.string().valid("pending","accepted")}),m=p.object().keys({token:p.string().required()}),v=p.object().keys({id:p.string().required(),password:p.string().required(),token:p.string().required()}),y=p.object().keys({from:p.string().email().required(),subject:p.string().required(),html:p.string().required()});p.object().keys({host:p.string().required(),port:p.number().required(),secure:p["boolean"]().required(),auth:p.object().keys({user:p.string().required(),pass:p.string().required()})}),e.exports={validateInviteUser:o,validateInvitations:i,validateUserToken:s,validateSavePassword:u,validateWriteTemplateConfig:a,validateTemplateConfigSchema:c}},function(e,t,n){e.exports={"default":n(89),__esModule:!0}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}t.__esModule=!0;var o=n(87),i=r(o);t["default"]=i["default"]||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var r=n(14),o=n(9),i=n(94),s=n(98),u="prototype",a=function(e,t,n){var c,l,f,d=e&a.F,p=e&a.G,h=e&a.S,g=e&a.P,m=e&a.B,v=e&a.W,y=p?o:o[t]||(o[t]={}),k=y[u],b=p?r:h?r[t]:(r[t]||{})[u];p&&(n=t);for(c in n)l=!d&&b&&void 0!==b[c],l&&c in y||(f=l?b[c]:n[c],y[c]=p&&"function"!=typeof b[c]?n[c]:m&&l?i(f,r):v&&b[c]==f?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t[u]=e[u],t}(f):g&&"function"==typeof f?i(Function.call,f):f,g&&((y.virtual||(y.virtual={}))[c]=f,e&a.R&&k&&!k[c]&&s(k,c,f)))};a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,e.exports=a},function(e,t,n){var r=n(93);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){var r=n(103),o=n(96);e.exports=Object.keys||function(e){return r(e,o)}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(28),o=n(26);e.exports=function(e){return r(o(e))}},function(e,t,n){var r=n(26);e.exports=function(e){return Object(r(e))}},function(e,t){"use strict";function n(e){Error.call(this,e),Error.captureStackTrace(this,this.constructor),this.name="ArgumentError",this.message=e}n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,e.exports=n},function(e,t){"use strict";function n(e){Error.call(this,e),Error.captureStackTrace(this,this.constructor),this.name="JwksError",this.message=e}n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,e.exports=n},function(e,t){"use strict";function n(e){Error.call(this,e),Error.captureStackTrace(this,this.constructor),this.name="JwksRateLimitError",this.message=e}n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,e.exports=n},function(e,t){"use strict";function n(e){Error.call(this,e),Error.captureStackTrace(this,this.constructor),this.name="SigningKeyNotFoundError",this.message=e}n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,e.exports=n},function(e,t){var n=function(e,t,n,r){if(this.bucketSize=e,this.tokensPerInterval=t,"string"==typeof n)switch(n){case"sec":case"second":this.interval=1e3;break;case"min":case"minute":this.interval=6e4;break;case"hr":case"hour":this.interval=36e5;break;case"day":this.interval=864e5}else this.interval=n;this.parentBucket=r,this.content=0,this.lastDrip=+new Date};n.prototype={bucketSize:1,tokensPerInterval:1,interval:1e3,parentBucket:null,content:0,lastDrip:0,removeTokens:function(e,t){function n(){var n=Math.ceil((e-r.content)*(r.interval/r.tokensPerInterval));return setTimeout(function(){r.removeTokens(e,t)},n),!1}var r=this;return this.bucketSize?e>this.bucketSize?(process.nextTick(t.bind(null,"Requested tokens "+e+" exceeds bucket size "+this.bucketSize,null)),!1):(this.drip(),e>this.content?n():this.parentBucket?this.parentBucket.removeTokens(e,function(o,i){return o?t(o,null):e>r.content?n():(r.content-=e,void t(null,Math.min(i,r.content)))}):(this.content-=e,process.nextTick(t.bind(null,null,this.content)),!0)):(process.nextTick(t.bind(null,null,e,Number.POSITIVE_INFINITY)),!0)},tryRemoveTokens:function(e){return!(this.bucketSize&&(e>this.bucketSize||(this.drip(),e>this.content||this.parentBucket&&!this.parent.tryRemoveTokens(e)||(this.content-=e,0))))},drip:function(){if(!this.tokensPerInterval)return void(this.content=this.bucketSize);var e=+new Date,t=Math.max(e-this.lastDrip,0);this.lastDrip=e;var n=t*(this.tokensPerInterval/this.interval);this.content=Math.min(this.content+n,this.bucketSize)}},e.exports=n},function(e,t,n){const r=n(42),o=n(4),i=["max","maxAge","length","dispose","stale"];e.exports=function(e){const t=new r(o.pick(e,i)),n=e.load,s=e.hash,u=e.bypass,a=e.itemMaxAge,c=new Map;if(e.disable)return n;const l=function(){const e=o.toArray(arguments),r=e.slice(0,-1),i=e.slice(-1).pop(),l=this;var f;if(u&&u.apply(l,r))return n.apply(l,e);f=0!==r.length||s?s.apply(l,r):"_";var d=t.get(f);return d?i.apply(null,[null].concat(d)):void(c.get(f)?c.get(f).push(i):(c.set(f,[]),n.apply(l,r.concat(function(e){const n=o.toArray(arguments);if(!e){const s=n.slice(1);a?t.set(f,s,a.apply(l,r.concat(s))):t.set(f,s)}c.get(f).forEach(function(e){e.apply(null,n)}),c["delete"](f),i.apply(null,n)}))))};return l.keys=t.keys.bind(t),l},e.exports.sync=function(e){const t=new r(o.pick(e,i)),n=e.load,s=e.hash,u=e.disable,a=e.bypass,c=this,l=e.itemMaxAge;if(u)return n;const f=function(){var e=o.toArray(arguments);if(a&&a.apply(c,arguments))return n.apply(c,arguments);var r=s.apply(c,e),i=t.get(r);if(i)return i;const u=n.apply(c,e);return l?t.set(r,u,l.apply(c,e.concat([u]))):t.set(r,u),u};return f.keys=t.keys.bind(t),f}},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("ejs")},function(e,t){e.exports=require("express-jwt")},function(e,t){e.exports=require("lru-cache")},function(e,t){e.exports=require("ms")},function(e,t){e.exports=require("request")},function(e,t){e.exports=require("superagent")},function(e,t){e.exports=require("webtask-tools")},function(e,t,n){function r(e){return e=e.match(/.{1,64}/g).join("\n"),e="-----BEGIN CERTIFICATE-----\n"+e,e+="\n-----END CERTIFICATE-----\n"}var o=n(42),i=n(44),s=n(4),u={max:5242880,length:function(e){return e.length},maxAge:3e5},a=o(u);e.exports=function(e){return e=e||{},e.strictSSL="undefined"==typeof e.strictSSL||e.strictSSL,function(t,n,o,u){var c=o.iss+"|"+o.aud,l=a.get(c);if(l)return u(null,l);switch(n.alg){case"RS256":var f=o.iss+".well-known/jwks.json";i.get(f,{json:!0,strictSSL:e.strictSSL},function(e,t,i){if(e)return u(e);if(200!==t.statusCode)return u(new Error("Failed to obtain JWKS from "+o.iss));var l=s.find(i.keys,function(e){return e.kid==n.kid});if(!l)return u(new Error("Failed to obtain signing key used by "+o.iss));var f=r(l.x5c[0]);return a.set(c,f),u(null,f)});break;default:return u(new Error("Unsupported JWT algorithm: "+n.alg))}}}},function(e,t,n){const r=n(41),o=n(117),i=n(2).UnauthorizedError;e.exports=function(e,t){return r({secret:o.expressJwtSecret({cache:!0,rateLimit:!0,jwksRequestsPerMinute:5,jwksUri:"https://"+e+"/.well-known/jwks.json",handleSigningKeyError:function(e,t){return t(e instanceof o.SigningKeyNotFoundError?new i("A token was provided with an invalid kid"):e)}}),audience:t,issuer:"https://"+e+"/",algorithms:["RS256"]})}},function(e,t,n){e.exports=function(e){return function(t,n,r,o){return e&&e(t),t&&t.status?(r.status(t.status),r.json({error:t.code||t.name,message:t.message||t.name})):(r.status(t.status||500),r.json({error:"InternalServerError",message:t.message||t.name}))}}},function(e,t,n){e.exports.authenticateUser=n(48),e.exports.requireUser=n(52),e.exports.errorHandler=n(49),e.exports.managementApiClient=n(51),e.exports.validateHookToken=n(53),e.exports.webtaskConfig=n(54)},function(e,t,n){const r=n(2);e.exports=function(e){return function(t,n,o){const i=t;r.managementApi.getClient(e).then(function(e){return i.auth0=e,o()})["catch"](function(e){o(e)})}}},function(e,t,n){const r=n(2).UnauthorizedError;e.exports=function(e,t,n){return e.user?n():n(new r("Authentication required for this endpoint."))}},function(e,t,n){const r=n(2);e.exports=function(e,t,n){if(null===e||void 0===e)throw new r.ArgumentError("Must provide the domain");if("string"!=typeof e||0===e.length)throw new r.ArgumentError("The provided domain is invalid: "+e);if(null===t||void 0===t)throw new r.ArgumentError("Must provide the webtaskUrl");if("string"!=typeof t||0===t.length)throw new r.ArgumentError("The provided webtaskUrl is invalid: "+t);if(null===n||void 0===n)throw new r.ArgumentError("Must provide the extensionSecret");if("string"!=typeof n||0===n.length)throw new r.ArgumentError("The provided extensionSecret is invalid: "+n);return function(o){if(null===o||void 0===o)throw new r.ArgumentError("Must provide the hookPath");if("string"!=typeof o||0===o.length)throw new r.ArgumentError("The provided hookPath is invalid: "+o);return function(i,s,u){if(i.headers.authorization&&"Bearer"===i.headers.authorization.split(" ")[0]){const a=i.headers.authorization.split(" ")[1];try{if(r.validateHookToken(e,t,o,n,a))return u()}catch(c){return u(c)}}return u(new r.HookTokenError("Hook token missing for the call to: "+o))}}}},function(e,t,n){const r=n(2);e.exports=function(e){return function(t,n,o){return t.webtaskContext&&e.setProvider(r.configProvider.fromWebtaskContext(t.webtaskContext)),o()}}},function(e,t,n){const r=n(2),o=n(46);e.exports.createServer=function(e){return o.fromExpress(r.createServer(e))}},function(e,t,n){const r=n(8),o=function(e,t){var n=r.parse(e).pathname||"";return n=n.replace(t,"").replace(/^\/|\/$/g,""),n.startsWith("/")||(n="/"+n),n.endsWith("/")||(n+="/"),n};e.exports.getBasePath=function(e){return o(e.originalUrl||"",e.path)},e.exports.getBaseUrl=function(e){const t=r.parse(e.originalUrl||"").pathname||"";return r.format({protocol:"https",host:e.get("host"),pathname:t.replace(e.path,"")})}},function(e,t,n){const r=n(43),o=n(20),i=n(128),s=n(11),u=n(38),a=n(45),c=n(1).ArgumentError,l=n(1).ManagementApiError,f=function(e,t,n){return new s(function(r,o){a.post("https://"+e+"/oauth/token").send({audience:"https://"+e+"/api/v2/",client_id:t,client_secret:n,grant_type:"client_credentials"}).set("Accept","application/json").end(function(e,n){return e&&401===e.status?o(new l("unauthorized","Invalid credentials for "+t,e.status)):e&&n&&n.body&&n.body.error?o(new l(n.body.error,n.body.error_description||n.body.error,e.status)):e?o(e):n.ok&&n.body.access_token?r(n.body.access_token):o(new l("unknown_error","Unknown error from Management Api or no access token was provided: "+(n.text||n.status)))})})},d=s.promisify(u({load:function(e,t,n,r){f(e,t,n).then(function(e){return r(null,e)})["catch"](function(e){return r(e)})},hash:function(e,t,n){return e+"-"+t+"-"+n},itemMaxAge:function(e,t,n,r){try{const i=o.decode(r),s=new Date(0);s.setUTCSeconds(i.exp);const u=(new Date).valueOf();return s.valueOf()-u-1e4}catch(a){return 1e3}},max:100,maxAge:r("1h")}));e.exports.getAccessToken=f,e.exports.getAccessTokenCached=d,e.exports.getClient=function(e){if(null===e||void 0===e)throw new c("An options object must be provided");if(null===e.domain||void 0===e.domain)throw new c("An options object must contain the domain");if("string"!=typeof e.domain||0===e.domain.length)throw new c("The provided domain is invalid: "+e.domain);if(e.accessToken){if("string"!=typeof e.accessToken||0===e.accessToken.length)throw new c("The provided accessToken is invalid");return s.resolve(new i.ManagementClient({domain:e.domain,token:e.accessToken}))}if(null===e.clientId||void 0===e.clientId)throw new c("An options object must contain the clientId");if("string"!=typeof e.clientId||0===e.clientId.length)throw new c("The provided clientId is invalid: "+e.clientId);if(null===e.clientSecret||void 0===e.clientSecret)throw new c("An options object must contain the clientSecret");if("string"!=typeof e.clientSecret||0===e.clientSecret.length)throw new c("The provided clientSecret is invalid");return d(e.domain,e.clientId,e.clientSecret).then(function(t){return new i.ManagementClient({domain:e.domain,token:t})})}},function(e,t){e.exports=function(){var e=null;const t=function(t){if(!e)throw new Error("A configuration provider has not been set");return e(t)};return t.setProvider=function(t){e=t},t}},function(e,t){function n(e){Error.call(this,e),Error.captureStackTrace(this,this.constructor),this.name="ArgumentError",this.message=e,this.status=400}n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,e.exports=n},function(e,t){function n(e){Error.call(this,e),Error.captureStackTrace(this,this.constructor),this.name="ForbiddenError",this.message=e,this.status=403}n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,e.exports=n},function(e,t){function n(e,t){Error.call(this,e),Error.captureStackTrace(this,this.constructor),this.name="HookTokenError",this.message=e,this.status=401,this.innerError=t}n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,e.exports=n},function(e,t){function n(e,t,n){Error.call(this,t),Error.captureStackTrace(this,this.constructor),this.name="ManagementApiError",this.code=e,this.message=t,this.status=n||400}n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,e.exports=n},function(e,t){function n(e){Error.call(this,e),Error.captureStackTrace(this,this.constructor),this.name="NotFoundError",this.message=e,this.status=404}n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,e.exports=n},function(e,t){function n(e){Error.call(this,e),Error.captureStackTrace(this,this.constructor),this.name="UnauthorizedError",this.message=e,this.status=401}n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,e.exports=n},function(e,t){function n(e){Error.call(this,e),Error.captureStackTrace(this,this.constructor),this.name="ValidationError",this.message=e,this.status=400}n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,e.exports=n},function(e,t,n){const r=n(20),o=n(1).HookTokenError;e.exports=function(e,t,n,i,s){if(!s)throw new o("Hook token missing");try{return r.verify(s,i,{audience:t+n,issuer:"https://"+e}),!0}catch(u){throw new o("Invalid hook token",u)}}},function(e,t,n){function r(e){if(null===e||void 0===e)throw new s("Must provide a storage context");this.storageContext=e}const o=n(4),i=n(134),s=n(1).ArgumentError,u=n(1).NotFoundError,a=n(1).ValidationError,c=function(e,t){return e.read(t).then(function(e){return e[t]=e[t]||[],e})};r.prototype.getAll=function(e){return c(this.storageContext,e).then(function(t){return t[e]})},r.prototype.get=function(e,t){return this.getAll(e).then(function(n){const r=o.find(n,function(e){return e._id===t});return r?r:Promise.reject(new u("The record "+t+" in "+e+" does not exist."))})},r.prototype.create=function(e,t){const n=this.storageContext;return c(n,e).then(function(r){t._id||(t._id=i.v4());const s=o.findIndex(r[e],function(e){return e._id===t._id});return s>-1?Promise.reject(new a("The record "+t._id+" in "+e+" already exists.")):(r[e].push(t),n.write(r).then(function(){return t}))})},r.prototype.update=function(e,t,n,r){const i=this.storageContext;return c(i,e).then(function(s){const a=o.findIndex(s[e],function(e){return e._id===t});if(a<0&&!r)throw new u("The record "+t+" in "+e+" does not exist.");const c=o.extend({_id:t},a<0?{}:s[e][a],n);return a<0?s[e].push(c):s[e][a]=c,i.write(s).then(function(){return c})})},r.prototype["delete"]=function(e,t){const n=this.storageContext;return c(n,e).then(function(r){const i=o.findIndex(r[e],function(e){return e._id===t});return!(i<0)&&(r[e].splice(i,1),n.write(r).then(function(){return!0}))})},e.exports=r},function(e,t,n){const r=n(21);e.exports.createServer=function(e){var t=null;return function(n,o){if(!t){const i=r.fromWebtaskContext(n.webtaskContext);t=e(n,i,n.webtaskContext.storage)}return t(n,o)}}},function(e,t,n){function r(e,t){if(null===e||void 0===e)throw new u("Must provide the path to the file");if("string"!=typeof e||0===e.length)throw new u("The provided path is invalid: "+e);t=t||{mergeWrites:!0},this.path=e,this.mergeWrites=t.mergeWrites,this.defaultData=t.defaultData||{}}const o=n(4),i=n(19),s=n(11),u=n(1).ArgumentError;r.prototype.read=function(){const e=this;return new s(function(t,n){i.readFile(e.path,"utf8",function(r,o){if(r)return"ENOENT"===r.code?t(e.defaultData):n(r);try{return t(o&&o.length?JSON.parse(o):e.defaultData)}catch(i){return n(i)}})})},r.prototype.write=function(e){const t=this;var n=s.resolve(e);return t.mergeWrites&&(n=n.then(function(e){return t.read().then(function(t){return o.extend({},t,e)})})),n.then(function(e){return new s(function(n,r){try{return i.writeFile(t.path,JSON.stringify(e,null,2),"utf8",function(e){return e?r(e):n()})}catch(o){return r(o)}})})},e.exports=r},function(e,t,n){e.exports.FileStorageContext=n(69),e.exports.WebtaskStorageContext=n(71)},function(e,t,n){function r(e,t){if(null===e||void 0===e)throw new i("Must provide the Webtask storage object");t=t||{force:1},this.storage=e,this.options=t,this.defaultData=t.defaultData||{}}const o=n(11),i=n(1).ArgumentError;r.prototype.read=function(){const e=this;return new o(function(t,n){e.storage.get(function(r,o){return r?n(r):t(o||e.defaultData)})})},r.prototype.write=function(e){const t=this;return new o(function(n,r){t.storage.set(e,t.options,function(e){return e?r(e):n()})})},e.exports=r},function(e,t,n){function r(e){return e&&"[object Function]"==h.call(e)}function o(e){return function(t,n,r){p.get(e+"/userinfo").set("Authorization","Bearer "+t.body.access_token).end(function(e,o){return e?void n.redirect(n.locals.baseUrl):(t.userInfo=o.body,void r())})}}function i(e,t){return function(n,o,i){var s=e;r(e)&&(s=e(n)),n.apiToken=d.sign(n.userInfo,s,{algorithm:"HS256",issuer:o.locals.baseUrl,expiresIn:t}),delete n.userinfo,i()}}var s=n(7),u=n(131),a=n(41),c=n(8),l=n(47),f=n(39),d=n(20),p=n(45),h={}.toString;e.exports=function(e){var t=864e5,r=s.Router(),d=function(e,t,n){n()},p=[d];return e=e||{},e.clientName=e.clientName||"Auth0 Extension",e.clientId=e.clientId,e.exp=e.exp||t,e.credentialsRequired="undefined"!=typeof e.credentialsRequired&&e.credentialsRequired,e.scopes=e.scopes+" openid profile",e.responseType=e.responseType||"token",e.tokenExpiresIn=e.tokenExpiresIn||"10h",e.rootTenantAuthority=e.rootTenantAuthority||"https://auth0.auth0.com",e.authenticatedCallback=e.authenticatedCallback||function(e,t,n,r){r()},e.apiToken&&!e.apiToken.secret&&(console.log('You are using a "development secret" for API token generation. Please setup your secret on "apiToken.secret".'),e.apiToken.secret=n(129).randomBytes(32).toString("hex")),e.apiToken&&e.apiToken.secret&&(p=[o(e.rootTenantAuthority),e.apiToken.payload||d,i(e.apiToken.secret,e.tokenExpiresIn)]),r.use(function(e,t,n){var r="https",o=c.parse(e.originalUrl).pathname.replace(e.path,"");t.locals.baseUrl=c.format({protocol:r,host:e.get("host"),pathname:o}),n()}),r.use(f.urlencoded({extended:!1})),r.use(a({secret:l(),algorithms:["RS256"],credentialsRequired:e.credentialsRequired}).unless({path:["/login","/callback"]})),r.get("/login",function(t,n){var r=n.locals.baseUrl+"/callback";t.query.returnTo&&(r+="?returnTo="+encodeURIComponent(t.query.returnTo));var o;if("string"==typeof e.audience)o="&audience="+encodeURIComponent(e.audience);else if("function"==typeof e.audience){var i=e.audience(t);"string"==typeof i&&(o="&audience="+encodeURIComponent(i))}var s=[e.rootTenantAuthority+"/i/oauth2/authorize","?client_id="+(e.clientId||n.locals.baseUrl),"&response_type="+e.responseType,"&response_mode=form_post","&scope="+encodeURIComponent(e.scopes),"&expiration="+e.exp,"&redirect_uri="+r,o].join("");n.redirect(s)}),r.get("/logout",function(t,n){var r=["html","  head","    script.","      sessionStorage.removeItem('token')","      sessionStorage.removeItem('apiToken')","      window.location.href = '"+e.rootTenantAuthority+"/v2/logout?returnTo=#{baseUrl}';","  body"].join("\n"),o=u.compile(r)({baseUrl:n.locals.baseUrl});n.header("Content-Type","text/html"),n.status(200).send(o)}),r.post("/callback",p,function(t,n){e.authenticatedCallback(t,n,t.body.access_token,function(e){if(e)return n.sendStatus(500);var r=["html","  head","    script.","      sessionStorage.setItem('token', '"+t.body.access_token+"');",1===p.length?"":"      sessionStorage.setItem('apiToken', '"+t.apiToken+"');","      window.location.href = '#{returnTo}';","  body"].join("\n"),o=u.compile(r)({returnTo:t.query.returnTo?t.query.returnTo:n.locals.baseUrl});n.header("Content-Type","text/html"),n.status(200).send(o)})}),r.get("/.well-known/oauth2-client-configuration",function(t,n){n.header("Content-Type","application/json"),n.status(200).send({redirect_uris:[n.locals.baseUrl+"/callback"],client_name:e.clientName,post_logout_redirect_uris:[n.locals.baseUrl]})}),r}},function(e,t,n){(function(t){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){return e&&e.__esModule?e:{"default":e}}var i=n(12),s=o(i),u=n(133),a=o(u),c=n(7),l=o(c),f=n(39),d=o(f),p=n(2),h=r(p),g=n(5),m=n(3),v=o(m),y=n(83),k=o(y),b=n(6),x=o(b);e.exports=function(e,n){v["default"].setProvider(e);var r=n?new h.WebtaskStorageContext(n,{force:1}):new h.FileStorageContext(s["default"].join(t,"./data.json"),{mergeWrites:!0}),o=new l["default"];return o.use(function(e,t,n){e.webtaskContext&&v["default"].setProvider(h.configProvider.fromWebtaskContext(e.webtaskContext)),n()}),o.use((0,a["default"])(":method :url :status :response-time ms - :res[content-length]",{stream:x["default"].stream})),o.use(d["default"].json({verify:function(e,t,n,r){n&&n.length&&(e.rawBody=n.toString(r||"utf8"));
}})),o.use(d["default"].urlencoded({extended:!1})),o.use("/app",l["default"]["static"](s["default"].join(t,"../dist"))),o.use("/",(0,k["default"])(r)),o.use(g.middlewares.errorHandler(x["default"].error)),o}}).call(t,"/")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){e.auth0.connections.getAll({fields:"name,options",strategy:"auth0"}).then(function(e){return s["default"].chain(e).sortBy(function(e){return e.name.toLowerCase()}).value()}).then(function(e){return s["default"].map(e,function(e){return{name:e.name,requires_username:!!e.options.requires_username&&e.options.requires_username}})}).then(function(e){return t(null,e)})["catch"](t)}var i=n(4),s=r(i);e.exports={getConnections:o}},function(e,t,n){"use strict";function r(e,t,n){s(e,t,n)}var o=n(135),i=void 0,s=void 0;e.exports=function(e,t){return i=o.createTransport(e),s=i.templateSender(t),{sendEmail:r}}},function(e,t,n){"use strict";var r=n(12),o=n(8);e.exports=function(e,t,n){return o.format({protocol:"production"!==e?"http":"https",host:t,pathname:r.join("changepassword",n)})}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(8),i=r(o),s=n(72),u=r(s),a=n(3),c=r(a);t["default"]=function(){var e={credentialsRequired:!1,clientName:"Invite Only Extension",audience:function(){return"https://"+(0,c["default"])("AUTH0_DOMAIN")+"/api/v2/"}},t=(0,u["default"])(e);return function(n,r,o){var s="https",u=i["default"].parse(n.originalUrl).pathname.replace(n.path,""),a=i["default"].format({protocol:s,host:n.get("host"),pathname:u});return e.clientId=a,t(n,r,o)}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.dashboardAdmins=void 0;var o=n(77),i=r(o);t.dashboardAdmins=i["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.readConfigStatus=t.writeTemplateConfig=t.writeStorage=t.readStorage=void 0;var o=n(24),i=r(o),s=n(11),u=r(s),a=n(6),c=(r(a),n(23)),l=r(c),f={templateConfig:{subject:"Welcome to Auth0",html:'<p>Welcome {{ email }}!</p>\n<p>You were invited to join Auth0.</p>\n<p>Click <a href="{{ url }}">here</a> to set your password.</p>'}},d=t.readStorage=function(e){return new u["default"](function(t,n){return e.read().then(function(e){return t(e&&0===(0,i["default"])(e).length?f:e)})["catch"](function(e){return n(e)})})},p=t.writeStorage=function(e,t){return new u["default"](function(n,r){return e.write(t).then(function(){return n()})["catch"](function(e){return r(e)})})};t.writeTemplateConfig=function(e,t){return d(e).then(function(e){return e.templateConfig=t||{},e}).then(function(t){return p(e,t)})},t.readConfigStatus=function(e){return d(e).then(function(e){return new u["default"](function(t,n){l["default"].validateTemplateConfigSchema(e.templateConfig,function(e,r){return e?n():t()})})}).then(function(){return{hasData:!0}})["catch"](function(){return{hasData:!1}})}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n){var r={auth0:e.auth0};s["default"].getConnections(r,function(e,n){return e?t.status(e.statusCode||500).send(e):t.json({result:n})})}var i=n(74),s=r(i);e.exports={getConnectionsHandler:o}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),i=n(5),s=n(3),u=r(s),a=n(6),c=r(a);t["default"]=function(){var e=i.middlewares.validateHookToken((0,u["default"])("AUTH0_DOMAIN"),(0,u["default"])("WT_URL"),(0,u["default"])("EXTENSION_SECRET")),t=(0,o.Router)();return t.use("/on-uninstall",e("/.extensions/on-uninstall")),t.use(i.middlewares.managementApiClient({domain:(0,u["default"])("AUTH0_DOMAIN"),clientId:(0,u["default"])("AUTH0_CLIENT_ID"),clientSecret:(0,u["default"])("AUTH0_CLIENT_SECRET")})),t["delete"]("/on-uninstall",function(e,t){c["default"].debug("Uninstall running..."),e.auth0.clients["delete"]({client_id:(0,u["default"])("AUTH0_CLIENT_ID")}).then(function(){c["default"].debug("Deleted client: "+(0,u["default"])("AUTH0_CLIENT_ID")),t.sendStatus(204)})["catch"](function(e){c["default"].debug("Error deleting client: "+(0,u["default"])("AUTH0_CLIENT_ID")),c["default"].error(e),t.sendStatus(204)})}),t}},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(19),i=r(o),s=n(8),u=(r(s),n(40)),a=r(u),c=n(12),l=r(c),f=n(5),d=n(3),p=r(d);t["default"]=function(){var t='\n  <!DOCTYPE html>\n  <html lang="en">\n  <head>\n    <title>Auth0 - User Invitations</title>\n    <meta charset="UTF-8" />\n    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />\n    <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n    <link rel="shortcut icon" href="https://cdn.auth0.com/styleguide/4.8.10/lib/logos/img/favicon.png">\n    <meta name="viewport" content="width=device-width, initial-scale=1">\n    <link rel="stylesheet" type="text/css" href="https://cdn.auth0.com/styles/zocial.min.css">\n    <link rel="stylesheet" type="text/css" href="https://cdn.auth0.com/manage/v0.3.1715/css/index.min.css">\n    <link rel="stylesheet" type="text/css" href="https://cdn.auth0.com/styleguide/4.8.10/index.css">\n    <% if (assets.style) { %><link rel="stylesheet" type="text/css" href="/app/<%= assets.style %>"><% } %>\n    <% if (assets.version) { %><link rel="stylesheet" type="text/css" href="//cdn.auth0.com/extensions/auth0-user-invite-extension/assets/auth0-user-invite-extension.ui.<%= assets.version %>.css"><% } %>\n  </head>\n  <body class="a0-extension">\n    <div id="app"></div>\n    <script type="text/javascript" src="//cdn.auth0.com/js/lock-9.0.min.js"></script>\n    <script type="text/javascript" src="//cdn.auth0.com/manage/v0.3.1715/js/bundle.js"></script>\n    <script type="text/javascript">window.config = <%- JSON.stringify(config) %>;</script>\n    <% if (assets.vendors) { %><script type="text/javascript" src="/app/<%= assets.vendors %>"></script><% } %>\n    <% if (assets.app) { %><script type="text/javascript" src="/app/<%= assets.app %>"></script><% } %>\n    <% if (assets.version) { %>\n    <script type="text/javascript" src="https://28c3d530.ngrok.io/extensions/auth0-user-invite-extension/assets/auth0-user-invite-extension.ui.vendors.<%= assets.version %>.js"></script>\n    <script type="text/javascript" src="https://28c3d530.ngrok.io/extensions/auth0-user-invite-extension/assets/auth0-user-invite-extension.ui.<%= assets.version %>.js"></script>\n    <% } %>\n  </body>\n  </html>\n  ';return function(n,r){var o={AUTH0_DOMAIN:(0,p["default"])("AUTH0_DOMAIN"),BASE_URL:f.urlHelpers.getBaseUrl(n),BASE_PATH:f.urlHelpers.getBasePath(n)},s=(0,p["default"])("CLIENT_VERSION");return s?r.send(a["default"].render(t,{config:o,assets:{version:s}})):i["default"].readFile(l["default"].join(e,"../../dist/manifest.json"),"utf8",function(e,n){var i={config:o,assets:{app:"bundle.js"}};!e&&n&&(i.assets=JSON.parse(n)),r.send(a["default"].render(t,i))})}}}).call(t,"/")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(24),i=r(o),s=n(7),u=n(126),a=r(u),c=n(5),l=n(86),f=r(l),d=n(82),p=r(d),h=n(81),g=r(h),m=n(84),v=r(m),y=n(3),k=r(y),b=n(22),x=r(b),w=n(23),E=r(w),S=n(78),_=n(79),T=n(80),j=r(T),C=n(85),I=r(C),A=function(e,t){e&&0!=(0,i["default"])(e).length&&e.host||(e=(0,a["default"])()),x["default"].configureEmail(e,t)};t["default"]=function(e){var t={host:(0,k["default"])("SMTP_HOST"),port:(0,k["default"])("SMTP_PORT"),secure:(0,k["default"])("SMTP_SECURE"),auth:{user:(0,k["default"])("SMTP_AUTH_USER"),pass:(0,k["default"])("SMTP_AUTH_PASS")}};(0,_.readStorage)(e).then(function(e){A(t,e.templateConfig)});var n=(0,s.Router)();n.use("/.extensions",(0,g["default"])()),n.use("/",(0,S.dashboardAdmins)()),n.get("/",(0,p["default"])()),n.get("/configuration",(0,p["default"])()),n.get("/changepassword/*",(0,f["default"])()),n.use("/meta",(0,v["default"])());var r=c.middlewares.managementApiClient({domain:(0,k["default"])("AUTH0_DOMAIN"),clientId:(0,k["default"])("AUTH0_CLIENT_ID"),clientSecret:(0,k["default"])("AUTH0_CLIENT_SECRET")});return n.use(r),n.get("/api/config/template",c.middlewares.requireUser,function(t,n,r){(0,_.readStorage)(e).then(function(e){n.json({result:e.templateConfig}||{})})["catch"](r)}),n.patch("/api/config/template",c.middlewares.requireUser,E["default"].validateWriteTemplateConfig,function(n,r,o){(0,_.writeTemplateConfig)(e,n.body).then(function(){A(t,n.body),r.sendStatus(200)})["catch"](o)}),n.get("/api/config/status",c.middlewares.requireUser,function(t,n,r){(0,_.readConfigStatus)(e).then(function(e){n.json({result:e})})["catch"](r)}),n.use("/api/connections",c.middlewares.requireUser,j["default"].getConnectionsHandler),n.post("/api/invitations/user",c.middlewares.requireUser,E["default"].validateInviteUser,I["default"].createUserHandler),n.get("/api/invitations",c.middlewares.requireUser,E["default"].validateInvitations,I["default"].getUsersHandler),n.put("/api/changepassword",E["default"].validateUserToken,I["default"].validateUserTokenHandler),n.post("/api/changepassword",E["default"].validateSavePassword,I["default"].savePasswordHandler),n}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),i=r(o),s=n(116),u=r(s);t["default"]=function(){var e=i["default"].Router();return e.get("/",function(e,t){t.status(200).send(u["default"])}),e}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n){var r={auth0:e.auth0,filter:e.query.filter,perPage:e.query.per_page,page:e.query.page};f["default"].getUsers(r,function(e,n){return e?t.status(e.statusCode||500).send((0,c["default"])({},e,{filter:r.filter})):t.json({result:n,filter:r.filter})})}function i(e,t,n){var r={auth0:e.auth0,connection:e.body.user.connection,email:e.body.user.email,username:e.body.user.username,host:e.get("host")};f["default"].createUser(r,function(e,n){return e?t.status(e.statusCode||500).send(e):t.sendStatus(201)})}function s(e,t,n){var r={auth0:e.auth0,token:e.query.token};f["default"].validateUserToken(r,function(e,n){return e?t.status(e.statusCode||500).send(e):t.json(n)})}function u(e,t,n){var r={auth0:e.auth0,id:e.body.id,password:e.body.password,token:e.body.token};f["default"].savePassword(r,function(e,n){return e?t.status(e.statusCode||500).send(e):t.sendStatus(204)})}var a=n(25),c=r(a),l=n(22),f=r(l);e.exports={getUsersHandler:o,createUserHandler:i,validateUserTokenHandler:s,savePasswordHandler:u}},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(40),i=r(o),s=n(19),u=n(12),a=r(u),c=n(3),l=r(c);t["default"]=function(){var t=(0,s.readFileSync)(a["default"].join(e,"./formTemplate.html"),"utf-8"),n=(0,s.readFileSync)(a["default"].join(e,"./changePassword.html"),"utf-8");return function(e,r){r.send(i["default"].render(n,{formTemplate:t.split(/\n/g).join(""),assets:{customCss:(0,l["default"])("CUSTOM_CSS")}},{escape:!1}))}}}).call(t,"/")},function(e,t,n){e.exports={"default":n(88),__esModule:!0}},function(e,t,n){n(113),e.exports=n(9).Object.assign},function(e,t,n){n(114),e.exports=n(9).Object.keys},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var r=n(15);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){var r=n(31),o=n(110),i=n(109);e.exports=function(e){return function(t,n,s){var u,a=r(t),c=o(a.length),l=i(s,c);if(e&&n!=n){for(;c>l;)if(u=a[l++],u!=u)return!0}else for(;c>l;l++)if((e||l in a)&&a[l]===n)return e||l||0;return!e&&-1}}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var r=n(90);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){var r=n(15),o=n(14).document,i=r(o)&&r(o.createElement);e.exports=function(e){return i?o.createElement(e):{}}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(101),o=n(106);e.exports=n(13)?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){e.exports=!n(13)&&!n(10)(function(){return 7!=Object.defineProperty(n(95)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){"use strict";var r=n(29),o=n(102),i=n(104),s=n(32),u=n(28),a=Object.assign;e.exports=!a||n(10)(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=a({},e)[n]||Object.keys(a({},t)).join("")!=r})?function(e,t){for(var n=s(e),a=arguments.length,c=1,l=o.f,f=i.f;a>c;)for(var d,p=u(arguments[c++]),h=l?r(p).concat(l(p)):r(p),g=h.length,m=0;g>m;)f.call(p,d=h[m++])&&(n[d]=p[d]);return n}:a},function(e,t,n){var r=n(91),o=n(99),i=n(111),s=Object.defineProperty;t.f=n(13)?Object.defineProperty:function(e,t,n){if(r(e),t=i(t,!0),r(n),o)try{return s(e,t,n)}catch(u){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(97),o=n(31),i=n(92)(!1),s=n(107)("IE_PROTO");e.exports=function(e,t){var n,u=o(e),a=0,c=[];for(n in u)n!=s&&r(u,n)&&c.push(n);for(;t.length>a;)r(u,n=t[a++])&&(~i(c,n)||c.push(n));return c}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){var r=n(27),o=n(9),i=n(10);e.exports=function(e,t){var n=(o.Object||{})[e]||Object[e],s={};s[e]=t(n),r(r.S+r.F*i(function(){n(1)}),"Object",s)}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var r=n(108)("keys"),o=n(112);e.exports=function(e){return r[e]||(r[e]=o(e))}},function(e,t,n){var r=n(14),o="__core-js_shared__",i=r[o]||(r[o]={});e.exports=function(e){return i[e]||(i[e]={})}},function(e,t,n){var r=n(30),o=Math.max,i=Math.min;e.exports=function(e,t){return e=r(e),e<0?o(e+t,0):i(e,t)}},function(e,t,n){var r=n(30),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},function(e,t,n){var r=n(15);e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t,n){var r=n(27);r(r.S+r.F,"Object",{assign:n(100)})},function(e,t,n){var r=n(32),o=n(29);n(105)("keys",function(){return function(e){return o(r(e))}})},function(e,t){e.exports={_args:[["nodemailer-stub-transport@^1.0.0","/Users/sericaia/Documents/git/authzero/auth0-user-invite-extension"]],_from:"nodemailer-stub-transport@>=1.0.0 <2.0.0",_id:"nodemailer-stub-transport@1.1.0",_inCache:!0,_installable:!0,_location:"/nodemailer-stub-transport",_nodeVersion:"6.3.1",_npmOperationalInternal:{host:"packages-16-east.internal.npmjs.com",tmp:"tmp/nodemailer-stub-transport-1.1.0.tgz_1471504393403_0.3326213986147195"},_npmUser:{email:"andris@kreata.ee",name:"andris"},_npmVersion:"3.10.3",_phantomChildren:{},_requested:{name:"nodemailer-stub-transport",raw:"nodemailer-stub-transport@^1.0.0",rawSpec:"^1.0.0",scope:null,spec:">=1.0.0 <2.0.0",type:"range"},_requiredBy:["#DEV:/"],_resolved:"https://registry.npmjs.org/nodemailer-stub-transport/-/nodemailer-stub-transport-1.1.0.tgz",_shasum:"11421d2d66b4ee6f405354f914c1f4641eb24b0d",_shrinkwrap:null,_spec:"nodemailer-stub-transport@^1.0.0",_where:"/Users/sericaia/Documents/git/authzero/auth0-user-invite-extension",author:{name:"Andris Reinman"},bugs:{url:"https://github.com/andris9/nodemailer-stub-transport/issues"},dependencies:{},description:"Stub transport for Nodemailer",devDependencies:{chai:"^3.5.0",grunt:"^1.0.1","grunt-cli":"^1.2.0","grunt-eslint":"^19.0.0","grunt-mocha-test":"^0.12.7",mocha:"^3.0.2",sinon:"^1.17.5"},directories:{},dist:{shasum:"11421d2d66b4ee6f405354f914c1f4641eb24b0d",tarball:"https://registry.npmjs.org/nodemailer-stub-transport/-/nodemailer-stub-transport-1.1.0.tgz"},gitHead:"8adb203c4ff434bf75649e0d1d98bb86c9bec3d8",homepage:"http://github.com/andris9/nodemailer-stub-transport",keywords:["Stub","Nodemailer"],license:"MIT",main:"src/stub-transport.js",maintainers:[{email:"andris@node.ee",name:"andris"}],name:"nodemailer-stub-transport",optionalDependencies:{},readme:"ERROR: No README data found!",repository:{type:"git",url:"git://github.com/andris9/nodemailer-stub-transport.git"},scripts:{test:"grunt"},version:"1.1.0"}},function(e,t){e.exports={title:"Invite Only Extension",name:"auth0-user-invite-extension",version:"1.0.0",author:"auth0",description:"This extension gives Auth0 customers the possibility to invite users to their connections.",type:"application",logoUrl:"https://cdn.auth0.com/extensions/auth0-user-invite-extension/assets/logo.svg",initialUrlPath:"/login",uninstallConfirmMessage:"Do you really want to uninstall this extension? Doing so will stop you from being able to invite users to your connections.",repository:"https://github.com/auth0-extensions/auth0-user-invite-extension",keywords:["auth0","extension"],auth0:{createClient:!0,onUninstallPath:"/.extensions/on-uninstall",scopes:"read:connections read:users create:users update:users"},secrets:{SMTP_HOST:{example:"smtp.my-domain.com",description:"SMTP server hostname",required:!0},SMTP_PORT:{example:"465",description:"SMTP server port",required:!0},SMTP_SECURE:{example:"true",description:"Require TLS?",required:!0},SMTP_AUTH_USER:{description:"SMTP authentication username",required:!0},SMTP_AUTH_PASS:{description:"SMTP authentication password",required:!0,type:"password"},CUSTOM_CSS:{description:"A CSS file containing custom styles for the extension change password page",example:"https://cdn.fabrikam.com/static/extensions/theme/fabrikam.css",required:!1}}}},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}var o=n(16),i=n(17),s=r(i),u=n(119),a=n(118);e.exports=function(e){return new o.JwksClient(e)},e.exports.ArgumentError=s.ArgumentError,e.exports.JwksError=s.JwksError,e.exports.JwksRateLimitError=s.JwksRateLimitError,e.exports.SigningKeyNotFoundError=s.SigningKeyNotFoundError,e.exports.expressJwtSecret=a.expressJwtSecret,e.exports.hapiJwt2Key=u.hapiJwt2Key},function(e,t,n){"use strict";var r=n(17),o=n(16),i=function(e,t){return e&&"SigningKeyNotFoundError"===e.name?t(null):e?t(e):void 0};e.exports.expressJwtSecret=function(e){if(null===e||void 0===e)throw new r.ArgumentError("An options object must be provided when initializing expressJwtSecret");var t=new o.JwksClient(e),n=e.handleSigningKeyError||i;return function(e,r,o,i){return r&&"RS256"===r.alg?void t.getSigningKey(r.kid,function(e,t){return e?n(e,function(e){return i(e,null)}):i(null,t.publicKey||t.rsaPublicKey)}):i(null,null)}}},function(e,t,n){"use strict";var r=n(17),o=n(16),i=function(e,t){return e&&"SigningKeyNotFoundError"===e.name?t(null,null,null):e?t(e,null,null):void 0};e.exports.hapiJwt2Key=function(e){if(null===e||void 0===e)throw new r.ArgumentError("An options object must be provided when initializing expressJwtSecret");var t=new o.JwksClient(e),n=e.handleSigningKeyError||i;return function(e,r){return e&&e.header?"RS256"!==e.header.alg?r(null,null,null):void t.getSigningKey(e.header.kid,function(e,t){return e?n(e,function(e){return r(e,null,null)}):r(null,t.publicKey||t.rsaPublicKey,t)}):r(null,null,null)}}},function(e,t){"use strict";function n(e){return e=e.match(/.{1,64}/g).join("\n"),e="-----BEGIN CERTIFICATE-----\n"+e+"\n-----END CERTIFICATE-----\n"}function r(e){var t=e[0];return t<"0"||t>"7"?"00"+e:e}function o(e){var t=e.toString(16);return t.length%2?"0"+t:t}function i(e){if(e<=127)return o(e);var t=o(e),n=128+t.length/2;return o(n)+t}function s(e,t){var n=new Buffer(e,"base64"),o=new Buffer(t,"base64"),s=r(n.toString("hex")),u=r(o.toString("hex")),a=s.length/2,c=u.length/2,l=i(a),f=i(c),d="30"+i(a+c+l.length/2+f.length/2+2)+"02"+l+s+"02"+f+u,p=new Buffer(d,"hex").toString("base64"),h="-----BEGIN RSA PUBLIC KEY-----\n";return h+=""+p.match(/.{1,64}/g).join("\n"),h+="\n-----END RSA PUBLIC KEY-----\n"}Object.defineProperty(t,"__esModule",{value:!0}),t.certToPEM=n,t.rsaPublicKeyToPEM=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){var t=arguments.length<=1||void 0===arguments[1]?options:arguments[1],n=t.cacheMaxEntries,r=void 0===n?5:n,o=t.cacheMaxAge,s=void 0===o?(0,i["default"])("10h"):o,a=(0,u["default"])("jwks"),l=e.getSigningKey;return a("Configured caching of singing keys. Max: "+r+" / Age: "+s),(0,c["default"])({load:function(e,t){l(e,function(n,r){return n?t(n):(a("Caching signing key for '"+e+"':",r),t(null,r))})},hash:function(e){return e},maxAge:s,max:r})};var o=n(43),i=r(o),s=n(18),u=r(s),a=n(38),c=r(a)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.rateLimitSigningKey=t.cacheSigningKey=void 0;var o=n(121),i=r(o),s=n(123),u=r(s);t.cacheSigningKey=i["default"],t.rateLimitSigningKey=u["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){var t=arguments.length<=1||void 0===arguments[1]?options:arguments[1],n=t.jwksRequestsPerMinute,r=void 0===n?10:n,o=(0,i["default"])("jwks"),u=e.getSigningKey,c=new s.RateLimiter(r,"minute",(!0));return o("Configured rate limiting to JWKS endpoint at "+r+"/minute"),function(e,t){c.removeTokens(1,function(n,r){return n?t(n):(o("Requests to the JWKS endpoint available for the next minute:",r),r<0?(o("Too many requests to the JWKS endpoint"),t(new a["default"]("Too many requests to the JWKS endpoint"))):u(e,t))})}};var o=n(18),i=r(o),s=n(124),u=n(35),a=r(u)},function(e,t,n){t.RateLimiter=n(125),t.TokenBucket=n(37)},function(e,t,n){var r=n(37),o=function(e,t,n){this.tokenBucket=new r(e,e,t,null),this.tokenBucket.content=e,this.curIntervalStart=+new Date,this.tokensThisInterval=0,this.fireImmediately=n};o.prototype={tokenBucket:null,curIntervalStart:0,tokensThisInterval:0,fireImmediately:!1,removeTokens:function(e,t){function n(n,o){return n?t(n,null):(r.tokensThisInterval+=e,void t(null,o))}if(e>this.tokenBucket.bucketSize)return process.nextTick(t.bind(null,"Requested tokens "+e+" exceeds maximum tokens per interval "+this.tokenBucket.bucketSize,null)),!1;var r=this,o=Date.now();if(o-this.curIntervalStart>=this.tokenBucket.interval&&(this.curIntervalStart=o,this.tokensThisInterval=0),e>this.tokenBucket.tokensPerInterval-this.tokensThisInterval){if(this.fireImmediately)process.nextTick(t.bind(null,null,-1));else{var i=Math.ceil(this.curIntervalStart+this.tokenBucket.interval-o);setTimeout(function(){r.tokenBucket.removeTokens(e,n)},i)}return!1}return this.tokenBucket.removeTokens(e,n)},tryRemoveTokens:function(e){if(e>this.tokenBucket.bucketSize)return!1;var t=Date.now();return t-this.curIntervalStart>=this.tokenBucket.interval&&(this.curIntervalStart=t,this.tokensThisInterval=0),!(e>this.tokenBucket.tokensPerInterval-this.tokensThisInterval)&&this.tokenBucket.tryRemoveTokens(e)},getTokensRemaining:function(){return this.tokenBucket.drip(),this.tokenBucket.content}},e.exports=o},function(e,t,n){"use strict";function r(e){i.call(this),this.options=e||{},this.name="Stub",this.version=o.version}var o=n(115),i=n(130).EventEmitter,s=n(136);e.exports=function(e){return new r(e)},s.inherits(r,i),r.prototype.isIdle=function(){return!0},r.prototype.verify=function(e){setImmediate(function(){return this.options.error?e(new Error(this.options.error)):e(null,!0)}.bind(this))},r.prototype.send=function(e,t){if(this.options.error)return void setImmediate(function(){t(new Error(this.options.error))}.bind(this));this.options.keepBcc&&(e.message.keepBcc=!0);var n=e.message.createReadStream(),r=[],o=0,i=e.data.envelope||e.message.getEnvelope();this._log("info","envelope",JSON.stringify(i)),this.emit("envelope",i),n.on("error",function(e){setImmediate(function(){t(e)})}),n.on("data",function(e){r.push(e),o+=e.length,this._log("verbose","message",e.toString()),this.emit("data",e.toString())}.bind(this)),n.on("end",function(){setImmediate(function(){var n=(e.message.getHeader("message-id")||"").replace(/[<>\s]/g,""),i=Buffer.concat(r,o),s={envelope:e.data.envelope||e.message.getEnvelope(),messageId:n,response:i};this._log("info","end","Processed <%s> (%sB)",n,i.length),this.emit("end",s),t(null,s)}.bind(this))}.bind(this))},r.prototype._log=function(){var e=Array.prototype.slice.call(arguments),t=(e.shift()||"INFO").toUpperCase(),n=e.shift()||"",r=s.format.apply(s,e);this.emit("log",{name:o.name,version:o.version,level:t,type:n,message:r})}},function(e,t){e.exports=require("async")},function(e,t){e.exports=require("auth0")},function(e,t){e.exports=require("crypto")},function(e,t){e.exports=require("events")},function(e,t){e.exports=require("jade")},function(e,t){e.exports=require("joi")},function(e,t){e.exports=require("morgan")},function(e,t){e.exports=require("node-uuid")},function(e,t){e.exports=require("nodemailer")},function(e,t){e.exports=require("util")},function(e,t){e.exports=require("uuid")},function(e,t){e.exports=require("winston")}]);